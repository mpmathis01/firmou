<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Firmou - Or√ßamentos, Pedidos e Recibos Gratuitos</title>
    <meta name="description"
        content="Gere or√ßamentos, faturas, recibos e promiss√≥rias em segundos. Gr√°tis, sem cadastro e 100% privado. Seus dados ficam no seu dispositivo.">

    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="image/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="image/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="image/apple-touch-icon.png">
    <link rel="manifest" href="site.webmanifest">
    <meta name="theme-color" content="#fbbf24">

    <!-- SEO & OpenGraph -->
    <meta property="og:title" content="Firmou - Gerador de Documentos Profissionais">
    <meta property="og:description" content="Or√ßamentos r√°pidos para MEIs e aut√¥nomos. Sem cadastro.">
    <meta name="robots" content="index, follow">

    <!-- JSON-LD Schemas -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Firmou",
      "applicationCategory": "BusinessApplication",
      "operatingSystem": "Web",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "BRL"
      },
      "description": "Gerador gratuito de or√ßamentos, faturas, recibos e promiss√≥rias para profissionais aut√¥nomos e MEIs",
      "featureList": ["Gera√ß√£o de PDF", "10 Templates Premium", "PIX QR Code", "Busca CNPJ/CEP", "Galeria de Fotos", "100% Offline"]
    }
    </script>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Como os dados s√£o salvos?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Tudo fica no LocalStorage do seu navegador. √â como se fosse uma gaveta digital dentro do seu Chrome ou Safari. Se voc√™ limpar o hist√≥rico de navega√ß√£o profundamente, esses dados podem sumir, por isso sempre recomendamos usar o bot√£o Exportar TXT."
          }
        },
        {
          "@type": "Question",
          "name": "D√° pra salvar em PDF?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Sim! Usamos uma biblioteca potente que fotografa o preview e gera um PDF no formato A4, pronto para enviar pelo WhatsApp."
          }
        },
        {
          "@type": "Question",
          "name": "√â realmente gr√°tis?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "100% gr√°tis, sem limites de uso. N√£o pedimos cart√£o de cr√©dito nem cadastro. A √∫nica pegadinha √© que mostramos an√∫ncios discretos para manter o projeto no ar."
          }
        }
      ]
    }
    </script>

    <!-- CDNs -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;900&family=Inter:wght@400;500;700;800&family=Playfair+Display:wght@700&family=Space+Mono&display=swap"
        rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode-generator/1.4.4/qrcode.min.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        outfit: ['Outfit', 'sans-serif'],
                        inter: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        firmou: {
                            dark: '#0f172a',
                            amber: '#fbbf24',
                        }
                    }
                }
            }
        }
    </script>

    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/preview.css">
    <link rel="stylesheet" href="css/templates.css">
    <link rel="stylesheet" href="css/components.css">
</head>

<body
    class="bg-gray-100 dark:bg-slate-900 transition-colors duration-300 font-inter text-slate-900 dark:text-slate-100 min-h-screen">

    <!-- TOP STICKY WRAPPER -->
    <div class="sticky top-0 z-[200]">
        <!-- UPDATE BANNER -->
        <div id="update-banner"
            class="hidden bg-red-600 text-white text-[10px] md:text-xs py-2 px-4 text-center font-bold">
            ‚ö†Ô∏è NOVA VERS√ÉO DISPON√çVEL! Salve seus dados em TXT antes de atualizar para n√£o perder nada.
            <button onclick="exportTXT()" class="underline ml-2">Exportar Agora</button> |
            <button onclick="location.reload()" class="underline ml-2">Atualizar</button>
        </div>

        <!-- MOBILE NAV -->
        <nav class="lg:hidden flex bg-slate-900 text-white h-14 shadow-xl">
            <button onclick="setMobileTab('edit')" id="btn-mob-edit"
                class="flex-1 flex items-center justify-center gap-2 border-b-4 border-firmou-amber"><i
                    class="fa-solid fa-pen"></i> Editar</button>
            <button onclick="setMobileTab('preview')" id="btn-mob-prev"
                class="flex-1 flex items-center justify-center gap-2 text-slate-400"><i class="fa-solid fa-eye"></i>
                Ver</button>
        </nav>
    </div>

    <!-- MAIN APP WRAPPER -->
    <main class="flex flex-row h-screen overflow-hidden">

        <!-- SIDEBAR EDITOR -->
        <aside id="sidebar"
            class="flex flex-shrink-0 w-[600px] bg-white dark:bg-slate-800 border-r dark:border-slate-700 flex-col z-20 overflow-hidden">
            <header
                class="p-6 border-b dark:border-slate-700 flex justify-start items-center bg-slate-50 dark:bg-slate-900">
                <div>
                    <div class="flex items-baseline tracking-tighter">
                        <span class="font-outfit font-black text-5xl">firmou</span>
                        <span id="logo-dot" class="font-outfit font-black text-5xl"
                            style="color:var(--accent-color)">.</span>
                    </div>
                    <p class="text-[10px] text-slate-500 uppercase font-bold tracking-widest mt-1">Gerador de Documentos
                    </p>
                </div>
                <div class="flex gap-4 ml-auto items-center">
                    <div class="flex flex-col items-center">
                        <button onclick="toggleDarkMode()" title="Alternar Modo Escuro"
                            class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700">
                            <i class="fa-solid fa-moon block dark:hidden"></i>
                            <i class="fa-solid fa-sun hidden dark:block"></i>
                        </button>
                        <span class="text-[8px] uppercase font-bold text-slate-400">Tema</span>
                    </div>

                    <div class="relative flex flex-col items-center">
                        <button onclick="resetData()" title="Limpar Tudo"
                            class="p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full">
                            <i class="fa-solid fa-trash-can"></i>
                        </button>
                        <span class="text-[8px] uppercase font-bold text-red-400">Limpar</span>

                        <!-- Info Badge 'i' -->
                        <div
                            class="absolute -top-1 -right-1 w-4 h-4 bg-amber-100 dark:bg-amber-900 text-amber-600 dark:text-amber-400 rounded-full flex items-center justify-center text-[10px] cursor-help font-black border border-amber-200 dark:border-amber-800 shadow-sm group">
                            i
                            <!-- Floating Tooltip -->
                            <div
                                class="absolute right-full top-0 mr-3 hidden group-hover:block w-48 bg-slate-900 dark:bg-slate-700 text-white text-[10px] p-2 rounded-lg shadow-2xl z-50 border border-slate-700 dark:border-slate-600 animate-in fade-in slide-in-from-right-1 pointer-events-none">
                                <p class="font-bold border-b border-white/10 pb-1 mb-1">CUIDADO! üóëÔ∏è</p>
                                <p>Esta a√ß√£o apaga todos os dados salvos para voc√™ come√ßar um novo documento do zero.
                                </p>
                                <div
                                    class="absolute left-full top-1 border-8 border-transparent border-l-slate-900 dark:border-l-slate-700">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- TABS -->
            <div id="tab-bar" class="flex border-b dark:border-slate-700 overflow-x-auto no-scrollbar">
                <button onclick="switchTab('info')" id="tab-info"
                    class="tab-active flex-shrink-0 px-6 py-4 text-xs font-bold uppercase tracking-wider">Dados</button>
                <button onclick="switchTab('items')" id="tab-items"
                    class="flex-shrink-0 px-6 py-4 text-xs font-bold uppercase tracking-wider text-slate-400">Itens</button>
                <button onclick="switchTab('payments')" id="tab-payments"
                    class="flex-shrink-0 px-6 py-4 text-xs font-bold uppercase tracking-wider text-slate-400">Pagamentos</button>
                <button onclick="switchTab('photos')" id="tab-photos"
                    class="flex-shrink-0 px-6 py-4 text-xs font-bold uppercase tracking-wider text-slate-400">Fotos</button>
                <button onclick="switchTab('design')" id="tab-design"
                    class="flex-shrink-0 px-6 py-4 text-xs font-bold uppercase tracking-wider text-slate-400">Estilo</button>
                <button onclick="switchTab('files')" id="tab-files"
                    class="flex-shrink-0 px-6 py-4 text-xs font-bold uppercase tracking-wider text-slate-400">Arquivos</button>
            </div>

            <!-- TAB CONTENT -->
            <div id="editor-content" class="flex-1 overflow-y-auto p-6 space-y-8 pb-32">

                <!-- TAB INFO -->
                <div id="sect-info" class="space-y-6">
                    <div class="bg-amber-50 dark:bg-amber-900/20 p-4 rounded-xl border border-amber-200 dark:border-amber-800 animate-pulse"
                        id="alert-fake">
                        <p class="text-xs text-amber-800 dark:text-amber-200 font-bold">üí° MODO EXEMPLO ATIVADO</p>
                        <p class="text-[10px] text-amber-700 dark:text-amber-400 mt-1">Estes dados s√£o fict√≠cios para
                            voc√™ ver como funciona. Limpe tudo para come√ßar o seu.</p>
                        <button onclick="clearFakeData()"
                            class="mt-2 text-[10px] bg-amber-600 text-white px-3 py-1 rounded-full font-bold">Limpar
                            Tudo</button>
                    </div>

                    <div class="space-y-4">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest border-b pb-2">O que voc√™
                            est√° gerando?</h3>
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Tipo de
                                    Documento</label>
                                <select id="docType"
                                    class="w-full bg-gray-50 dark:bg-slate-700 p-3 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    onchange="upd()">
                                    <option value="OR√áAMENTO">Or√ßamento</option>
                                    <option value="PEDIDO">Pedido</option>
                                    <option value="RECIBO">Recibo</option>
                                    <option value="PROMISS√ìRIA">Promiss√≥ria</option>
                                    <option value="COBRAN√áA">Cobran√ßa</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">N¬∫
                                    Identifica√ß√£o</label>
                                <input type="text" id="docNum" placeholder="N¬∫ Documento"
                                    class="w-full bg-gray-50 dark:bg-slate-700 p-3 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-3 mt-3">
                            <div>
                                <div class="flex justify-between items-center pr-1 mb-0.5">
                                    <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Data de
                                        Emiss√£o</label>
                                </div>
                                <input type="date" id="docDate"
                                    class="w-full bg-gray-50 dark:bg-slate-700 p-3 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                            <div>
                                <div class="flex justify-between items-center pr-1 mb-0.5">
                                    <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Validade</label>
                                    <div class="flex items-center gap-1.5" title="Exibir Validade no PDF">
                                        <input type="checkbox" id="docShowExp"
                                            class="w-3 h-3 accent-amber-500 rounded cursor-pointer" onchange="upd()">
                                        <span class="text-[8px] font-black text-slate-400 cursor-pointer"
                                            onclick="document.getElementById('docShowExp').click()">PDF</span>
                                    </div>
                                </div>
                                <input type="date" id="docDateExp"
                                    class="w-full bg-gray-50 dark:bg-slate-700 p-3 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                        </div>
                    </div>

                    <div class="space-y-4 pt-4">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest border-b pb-2">Seus Dados
                            (Emissor)</h3>
                        <div class="flex flex-col gap-2 w-1/2">
                            <label class="text-[10px] font-bold text-slate-500 ml-1">LOGOTIPO</label>
                            <div
                                class="flex flex-col items-center justify-center p-4 border-2 border-dashed rounded-lg bg-slate-50 dark:bg-slate-700/50">
                                <div
                                    class="w-16 h-16 bg-slate-100 rounded-lg flex items-center justify-center overflow-hidden border mb-2 group relative">
                                    <img id="logoPrev" class="max-h-full max-w-full hidden">
                                    <div id="logoPlaceholder" class="text-slate-300 text-2xl"><i
                                            class="fa-solid fa-image"></i></div>
                                </div>
                                <input type="file" id="logoInp" class="hidden" accept="image/*"
                                    onchange="handleLogo(event)">
                                <label for="logoInp"
                                    class="w-full text-center py-2 px-4 bg-white dark:bg-slate-800 border rounded cursor-pointer text-xs font-bold text-slate-600 hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors">
                                    <i class="fa-solid fa-upload mr-1"></i> Subir Logo
                                </label>
                            </div>
                        </div>
                        <div>
                            <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Documento
                                (CPF/CNPJ)</label>
                            <input type="text" id="myDoc" placeholder="CPF ou CNPJ"
                                class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                oninput="checkAPISearch('my')">
                        </div>
                        <div>
                            <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Nome Comercial ou Raz√£o
                                Social</label>
                            <input type="text" id="myName" placeholder="Seu Nome ou Empresa"
                                class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm font-bold border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                oninput="upd()">
                        </div>
                        <div class="grid grid-cols-4 gap-2">
                            <div class="col-span-1">
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">CEP</label>
                                <input type="text" id="myCep" placeholder="00000-000"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="maskCep(this)">
                            </div>
                            <div class="col-span-1">
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Estado</label>
                                <select id="myUF" onchange="loadCities(this.value, 'myCity'); upd()"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"></select>
                            </div>
                            <div class="col-span-2">
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Cidade
                                    (Munic√≠pio)</label>
                                <input type="text" id="myCity" list="myCityList" placeholder="Cidade"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                                <datalist id="myCityList"></datalist>
                            </div>
                        </div>
                        <div class="grid grid-cols-4 gap-2">
                            <div class="col-span-3">
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Logradouro (Rua,
                                    Av...)</label>
                                <input type="text" id="myStreet" placeholder="Nome da Rua"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                            <div class="col-span-1">
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">N√∫mero</label>
                                <input type="text" id="myNum" placeholder="N¬∫"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Bairro</label>
                                <input type="text" id="myNeigh" placeholder="Bairro"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                            <div>
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Complemento</label>
                                <input type="text" id="myComp" placeholder="Apto, Bloco..."
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                        </div>
                    </div>

                    <div class="space-y-4 pt-4">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest border-b pb-2">Dados do
                            Cliente</h3>
                        <div>
                            <label class="text-[8px] font-black text-slate-400 uppercase ml-1">CPF ou CNPJ do
                                Cliente</label>
                            <input type="text" id="clDoc" placeholder="CPF ou CNPJ do Cliente"
                                class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                oninput="checkAPISearch('cl')">
                        </div>
                        <div>
                            <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Nome do Cliente /
                                Tomador</label>
                            <input type="text" id="clName" placeholder="Nome do Cliente"
                                class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm font-bold border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                oninput="upd()">
                        </div>
                        <div class="grid grid-cols-4 gap-2">
                            <div class="col-span-1">
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">CEP</label>
                                <input type="text" id="clCep" placeholder="00000-000"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="maskCep(this)">
                            </div>
                            <div class="col-span-1">
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Estado</label>
                                <select id="clUF" onchange="loadCities(this.value, 'clCity'); upd()"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"></select>
                            </div>
                            <div class="col-span-2">
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Cidade
                                    (Munic√≠pio)</label>
                                <input type="text" id="clCity" list="clCityList" placeholder="Cidade"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                                <datalist id="clCityList"></datalist>
                            </div>
                        </div>
                        <div class="grid grid-cols-4 gap-2">
                            <div class="col-span-3">
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Logradouro (Rua,
                                    Av...)</label>
                                <input type="text" id="clStreet" placeholder="Nome da Rua"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                            <div class="col-span-1">
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">N√∫mero</label>
                                <input type="text" id="clNum" placeholder="N¬∫"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Bairro</label>
                                <input type="text" id="clNeigh" placeholder="Bairro"
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                            <div>
                                <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Complemento</label>
                                <input type="text" id="clComp" placeholder="Apto, Bloco..."
                                    class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                    oninput="upd()">
                            </div>
                        </div>
                    </div>

                </div>

                <!-- TAB PAYMENTS -->
                <div id="sect-payments" class="hidden space-y-4">
                    <div class="space-y-4 pt-4">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest border-b pb-2">Pagamento e
                            Termos</h3>
                        <div>
                            <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Chave Pix
                                Principal</label>
                            <input type="text" id="payPix" placeholder="Chave PIX (E-mail, Celular, etc)"
                                class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                oninput="upd()">
                        </div>
                        <div>
                            <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Condi√ß√µes Gerais de
                                Pagamento</label>
                            <textarea id="payTerms" placeholder="Termos e Condi√ß√µes (ex: Pagamento em 3x)"
                                class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm h-16 resize-none border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                oninput="upd()"></textarea>
                        </div>
                        <div>
                            <label class="text-[8px] font-black text-slate-400 uppercase ml-1">Observa√ß√µes
                                Adicionais</label>
                            <textarea id="payNotes" placeholder="Observa√ß√µes Extras"
                                class="w-full p-3 bg-gray-50 dark:bg-slate-700 rounded-lg text-sm h-16 resize-none border-none ring-1 ring-slate-200 dark:ring-slate-600"
                                oninput="upd()"></textarea>
                        </div>

                        <!-- PAGAMENTO AVAN√áADO -->
                        <div
                            class="bg-slate-50 dark:bg-slate-900/40 p-4 rounded-2xl border dark:border-slate-700 space-y-4">
                            <div class="flex items-center justify-between">
                                <h4 class="text-[10px] font-black text-slate-500 uppercase">Divis√£o de Pagamento</h4>
                                <button onclick="addPaySplit()"
                                    class="text-[9px] bg-blue-500 text-white px-3 py-1 rounded-full font-bold hover:bg-blue-600 transition-colors uppercase tracking-widest"><i
                                        class="fa-solid fa-plus mr-1"></i> Adicionar Etapa</button>
                            </div>

                            <div id="pay-split-list" class="space-y-3">
                                <!-- JS Render -->
                            </div>

                            <div
                                class="mt-4 p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg flex gap-3 items-start">
                                <i class="fa-solid fa-circle-exclamation text-amber-500 mt-0.5 text-sm"></i>
                                <p class="text-[10px] text-amber-800 dark:text-amber-200 leading-snug">
                                    <span class="font-bold block mb-1">IMPORTANTE:</span>
                                    O <b>Firmou.com</b> gera QR Codes est√°ticos baseados apenas na chave que voc√™
                                    digitou. N√≥s <b>n√£o processamos pagamentos</b>. Sempre confirme o recebimento do
                                    dinheiro no seu aplicativo banc√°rio antes de liberar o produto ou servi√ßo.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB ITEMS -->
                <div id="sect-items" class="hidden space-y-4">
                    <div class="flex justify-between items-center bg-slate-100 dark:bg-slate-700 p-3 rounded-lg">
                        <span class="text-[10px] font-black uppercase text-slate-500">Itens do Documento</span>
                        <button onclick="addItem()"
                            class="bg-blue-600 text-white px-4 py-1.5 rounded-lg text-xs font-bold shadow-lg"><i
                                class="fa-solid fa-plus"></i> Novo Item</button>
                    </div>
                    <div id="items-list" class="space-y-4"></div>
                </div>

                <!-- TAB PHOTOS -->
                <div id="sect-photos" class="hidden space-y-6">
                    <div
                        class="bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 p-4 rounded-xl border border-purple-200 dark:border-purple-800">
                        <div class="flex justify-between items-center mb-4">
                            <div class="flex-1">
                                <h4 class="text-sm font-bold text-purple-800 dark:text-purple-200">Galeria de Fotos</h4>
                                <p class="text-[10px] text-purple-600 dark:text-purple-400 mt-1">Mostre o antes/depois
                                    ou detalhes do servi√ßo</p>
                            </div>
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" id="showPhotos" onchange="upd()" class="rounded text-purple-600">
                                <span class="text-xs font-bold text-purple-700 dark:text-purple-300">Exibir no
                                    PDF</span>
                            </label>
                        </div>

                        <!-- T√≠tulo da Se√ß√£o Edit√°vel -->
                        <div class="mb-4">
                            <label
                                class="block text-[8px] font-black text-purple-600 dark:text-purple-400 uppercase mb-2">
                                T√≠tulo da Se√ß√£o no PDF
                            </label>
                            <input type="text" id="photoSectionTitle"
                                placeholder="Fotos do Local do Servi√ßo / Equipamento"
                                value="Fotos do Local do Servi√ßo / Equipamento"
                                class="w-full p-2 text-sm bg-white dark:bg-slate-700 rounded border border-purple-200 dark:border-purple-700"
                                oninput="upd()">
                        </div>

                        <div class="space-y-4">
                            <!-- Photo 1 -->
                            <div class="bg-white dark:bg-slate-800 p-3 rounded-lg border dark:border-slate-700">
                                <div class="flex gap-3 items-center">
                                    <div
                                        class="w-20 h-20 bg-slate-100 dark:bg-slate-700 rounded-lg flex items-center justify-center overflow-hidden border shrink-0">
                                        <img id="photo-prev-0" class="w-full h-full object-contain hidden">

                                        <i class="fa-solid fa-image text-2xl text-slate-300" id="photo-icon-0"></i>
                                    </div>
                                    <div class="flex-1 space-y-2">
                                        <label class="block">
                                            <span class="text-[8px] font-black text-slate-400 uppercase block mb-1">Foto
                                                1</span>
                                            <input type="file" accept="image/*" class="hidden" id="photo-0"
                                                onchange="handlePhoto(event, 0)">
                                            <button onclick="document.getElementById('photo-0').click()"
                                                class="w-full bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 p-2 rounded text-xs font-bold transition-colors">
                                                <i class="fa-solid fa-upload mr-1"></i> Escolher Foto
                                            </button>
                                        </label>
                                        <input type="text" id="photo-cap-0" placeholder="Legenda (opcional)"
                                            class="w-full p-2 text-xs bg-slate-50 dark:bg-slate-700 rounded border-none"
                                            oninput="upd()">
                                    </div>
                                </div>
                            </div>

                            <!-- Photo 2 -->
                            <div class="bg-white dark:bg-slate-800 p-3 rounded-lg border dark:border-slate-700">
                                <div class="flex gap-3 items-center">
                                    <div
                                        class="w-20 h-20 bg-slate-100 dark:bg-slate-700 rounded-lg flex items-center justify-center overflow-hidden border shrink-0">
                                        <img id="photo-prev-1" class="w-full h-full object-contain hidden">
                                        <i class="fa-solid fa-image text-2xl text-slate-300" id="photo-icon-1"></i>
                                    </div>
                                    <div class="flex-1 space-y-2">
                                        <label class="block">
                                            <span class="text-[8px] font-black text-slate-400 uppercase block mb-1">Foto
                                                2</span>
                                            <input type="file" accept="image/*" class="hidden" id="photo-1"
                                                onchange="handlePhoto(event, 1)">
                                            <button onclick="document.getElementById('photo-1').click()"
                                                class="w-full bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 p-2 rounded text-xs font-bold transition-colors">
                                                <i class="fa-solid fa-upload mr-1"></i> Escolher Foto
                                            </button>
                                        </label>
                                        <input type="text" id="photo-cap-1" placeholder="Legenda (opcional)"
                                            class="w-full p-2 text-xs bg-slate-50 dark:bg-slate-700 rounded border-none"
                                            oninput="upd()">
                                    </div>
                                </div>
                            </div>

                            <!-- Photo 3 -->
                            <div class="bg-white dark:bg-slate-800 p-3 rounded-lg border dark:border-slate-700">
                                <div class="flex gap-3 items-center">
                                    <div
                                        class="w-20 h-20 bg-slate-100 dark:bg-slate-700 rounded-lg flex items-center justify-center overflow-hidden border shrink-0">
                                        <img id="photo-prev-2" class="w-full h-full object-contain hidden">
                                        <i class="fa-solid fa-image text-2xl text-slate-300" id="photo-icon-2"></i>
                                    </div>
                                    <div class="flex-1 space-y-2">
                                        <label class="block">
                                            <span class="text-[8px] font-black text-slate-400 uppercase block mb-1">Foto
                                                3</span>
                                            <input type="file" accept="image/*" class="hidden" id="photo-2"
                                                onchange="handlePhoto(event, 2)">
                                            <button onclick="document.getElementById('photo-2').click()"
                                                class="w-full bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 p-2 rounded text-xs font-bold transition-colors">
                                                <i class="fa-solid fa-upload mr-1"></i> Escolher Foto
                                            </button>
                                        </label>
                                        <input type="text" id="photo-cap-2" placeholder="Legenda (opcional)"
                                            class="w-full p-2 text-xs bg-slate-50 dark:bg-slate-700 rounded border-none"
                                            oninput="upd()">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TAB DESIGN -->
                <div id="sect-design" class="hidden space-y-6">
                    <div class="space-y-4">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest">Cor Principal</h3>
                        <div class="flex gap-3 flex-wrap">
                            <div onclick="setCol('#fbbf24')"
                                class="w-10 h-10 rounded-full bg-amber-400 cursor-pointer border-4 border-white shadow-lg">
                            </div>
                            <div onclick="setCol('#2563eb')"
                                class="w-10 h-10 rounded-full bg-blue-600 cursor-pointer border-4 border-white shadow-lg">
                            </div>
                            <div onclick="setCol('#059669')"
                                class="w-10 h-10 rounded-full bg-emerald-600 cursor-pointer border-4 border-white shadow-lg">
                            </div>
                            <div onclick="setCol('#0f172a')"
                                class="w-10 h-10 rounded-full bg-slate-900 cursor-pointer border-4 border-white shadow-lg">
                            </div>
                            <input type="color" id="custCol" onchange="setCol(this.value)"
                                class="w-10 h-10 border-0 p-0 cursor-pointer bg-transparent">
                        </div>
                    </div>
                    <div class="space-y-4">
                        <h3 class="text-xs font-bold text-slate-400 uppercase tracking-widest">Modelos (Templates)</h3>
                        <div class="grid grid-cols-2 gap-3" id="tpl-grid"></div>
                    </div>
                </div>

                <!-- TAB FILES -->
                <div id="sect-files" class="hidden space-y-6">
                    <div
                        class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-200 dark:border-blue-800">
                        <h4 class="text-sm font-bold text-blue-800 dark:text-blue-200">Exportar/Importar Dados</h4>
                        <div id="file-toast" class="hidden opacity-0 -translate-y-2 transition-all duration-500"></div>
                        <p class="text-[10px] mt-2 text-blue-600 dark:text-blue-400">Salve seus or√ßamentos em seu
                            computador. Este site n√£o guarda nada em servidores.</p>
                        <div class="flex gap-2 mt-4">
                            <button onclick="exportTXT()"
                                class="flex-1 bg-blue-600 text-white py-2 rounded-lg text-xs font-bold">Exportar
                                TXT</button>
                            <label
                                class="flex-1 bg-white dark:bg-slate-700 text-blue-600 border border-blue-600 py-2 rounded-lg text-xs font-bold text-center cursor-pointer">
                                Importar TXT <input type="file" id="importInp" class="hidden"
                                    onchange="importTXT(event)">
                            </label>
                        </div>
                    </div>
                </div>

            </div>

            <!-- FLOATING FAB (BOTTOM) -->
            <div class="p-6 border-t dark:border-slate-700 bg-white dark:bg-slate-800 z-50">
                <button onclick="generatePDF()"
                    class="w-full bg-firmou-amber text-slate-900 font-black py-4 rounded-2xl shadow-[0_10px_30px_rgba(251,191,36,0.4)] flex items-center justify-center gap-3 active:scale-95 transition-all text-sm uppercase tracking-widest"
                    id="btn-pdf">
                    <i class="fa-solid fa-file-pdf text-xl"></i> Gerar PDF Profissional
                </button>
            </div>

            <!-- PROGRESS MODAL (LOCAL TO SIDEBAR) -->
            <div id="progress-modal"
                class="hidden absolute inset-0 z-[400] bg-slate-900/80 backdrop-blur flex items-center justify-center rounded-r-3xl">
                <div class="bg-white dark:bg-slate-800 p-8 rounded-2xl shadow-2xl w-80 text-center mx-4">
                    <h3 class="text-sm font-black text-slate-800 dark:text-white uppercase mb-4">Processando...</h3>
                    <div class="w-full bg-slate-200 dark:bg-slate-700 h-2 rounded-full overflow-hidden">
                        <div id="progress-bar-fill" class="h-full bg-amber-400 transition-all duration-300"
                            style="width: 0%"></div>
                    </div>
                    <p class="text-[10px] text-slate-400 mt-2 font-bold animate-pulse">Aguarde um momento</p>
                </div>
            </div>
        </aside>

        <!-- PREVIEW SECTION -->
        <section id="preview-side"
            class="flex flex-1 bg-slate-100 dark:bg-slate-900 overflow-y-auto relative flex-col items-center border-l dark:border-slate-800">

            <!-- SIMPLE ROBUST TOOLBAR -->
            <div id="zoom-toolbar"
                class="sticky top-6 z-[500] no-print mb-6 bg-slate-900 text-white px-2 py-2 rounded-full flex gap-2 items-center shadow-xl">

                <!-- Zoom Text -->
                <div class="flex items-center gap-1">
                    <button onclick="window.updateZoom(-0.1)"
                        class="hover:text-amber-400 p-2 rounded-full hover:bg-white/10 w-8 h-8 flex items-center justify-center"><i
                            class="fa-solid fa-minus"></i></button>
                    <span id="zoom-val" class="font-mono font-bold w-12 text-center text-sm">100%</span>
                    <button onclick="window.updateZoom(0.1)"
                        class="hover:text-amber-400 p-2 rounded-full hover:bg-white/10 w-8 h-8 flex items-center justify-center"><i
                            class="fa-solid fa-plus"></i></button>
                </div>

                <div class="w-px h-4 bg-white/20"></div>

                <!-- Fit Modes -->
                <div class="flex gap-1">
                    <button onclick="window.setFit('width')"
                        class="text-[10px] font-bold hover:text-amber-400 px-3 py-1 bg-white/5 rounded-full uppercase transition-colors">Largura</button>
                    <button onclick="window.setFit('page')"
                        class="text-[10px] font-bold hover:text-amber-400 px-3 py-1 bg-white/5 rounded-full uppercase transition-colors">P√°gina</button>
                </div>

                <div class="w-px h-4 bg-white/20"></div>

                <!-- Actions -->
                <button onclick="window.print()"
                    class="hover:text-amber-400 p-2 rounded-full hover:bg-white/10 w-8 h-8 flex items-center justify-center"
                    title="Imprimir"><i class="fa-solid fa-print"></i></button>
            </div>

            <script>
                // SIMPLE ZOOM CONTROLLER
                window.currentZoom = 1;

                window.updateZoom = function (delta) {
                    window.currentZoom = parseFloat((window.currentZoom + delta).toFixed(1));
                    if (window.currentZoom < 0.3) window.currentZoom = 0.3;
                    if (window.currentZoom > 3) window.currentZoom = 3;
                    applyZoom();
                }

                window.setFit = function (mode) {
                    const preview = document.getElementById('preview-side');
                    const width = preview.clientWidth;
                    const height = window.innerHeight * 0.8;
                    const a4w = 210 * 3.78; // A4 width in px
                    const a4h = 297 * 3.78; // A4 height in px

                    if (mode === 'width') window.currentZoom = (width - 80) / a4w;
                    if (mode === 'page') window.currentZoom = Math.min((width - 80) / a4w, (height - 80) / a4h);

                    window.currentZoom = parseFloat(window.currentZoom.toFixed(2));
                    applyZoom();
                }

                function applyZoom() {
                    console.log('üîç Applying Zoom:', window.currentZoom);
                    const root = document.getElementById('pdf-root');
                    if (root) {
                        root.style.transform = `scale(${window.currentZoom})`;
                        root.style.transformOrigin = 'top center';

                        // Fix height to allow scrolling
                        const slider = document.getElementById('pdf-root-wrapper');
                        /* 
                           Calcula a altura escalada. 
                           Se o conte√∫do tem 1000px e scale √© 0.5, visualmente ocupa 500px.
                           Mas o wrapper precisa saber o tamanho visual novo ou o layout flow cuida disso?
                           O transform scale n√£o muda o layout flow, ele s√≥ encolhe visualmente.
                           Ent√£o precisamos ajustar a margem inferior negativa para "puxar" o conte√∫do para cima.
                        */
                        const scrollHeight = root.scrollHeight;
                        const scaledHeight = scrollHeight * window.currentZoom;
                        const originalHeight = scrollHeight;
                        const diff = originalHeight - scaledHeight;

                        // Margin bottom negativo puxa o espa√ßo vazio
                        // root.style.marginBottom = `-${diff}px`; 
                        // Melhor: deixar o wrapper se virar com o scroll, mas garantir padding
                        root.style.marginBottom = '100px';
                    }
                    const val = document.getElementById('zoom-val');
                    if (val) val.innerText = Math.round(window.currentZoom * 100) + '%';

                    if (window.state && window.state.cfg) window.state.cfg.zoom = window.currentZoom;
                }

                // Init after load
                setTimeout(() => window.setFit('page'), 800);
            </script>

            <!-- THE ACTUAL A4 SIMULATOR -->
            <div id="pdf-root-wrapper">
                <div id="pdf-root" class="relative">
                    <div class="a4-container tpl-clean relative flex flex-col"
                        style="background: white; min-height: 297mm;">
                        <div style="padding: 40px; color: black;">
                            <h1 style="font-size: 24px; font-weight: bold; margin-bottom: 20px;">Carregando Preview...
                            </h1>
                            <p>Se esta mensagem n√£o desaparecer, h√° um problema no JavaScript.</p>
                            <p style="margin-top: 10px; font-size: 12px; color: #666;">Verifique o console (F12) para
                                erros.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PREMIUM PAGE NAVIGATION CONTROLS (Shows for multi-page documents) -->
            <div class="preview-nav-controls no-print">
                <button data-action="prev-page" title="P√°gina Anterior (Ctrl+PageUp)">
                    <i class="fa-solid fa-chevron-up"></i>
                </button>
                <div class="page-indicator">1 / 1</div>
                <button data-action="next-page" title="Pr√≥xima P√°gina (Ctrl+PageDown)">
                    <i class="fa-solid fa-chevron-down"></i>
                </button>
            </div>

            <!-- PREMIUM MINIMAP (Shows thumbnail navigation) -->
            <div class="preview-minimap no-print">
                <!-- Dynamically populated with page thumbnails -->
            </div>

            <script>
                function autoScale() {
                    console.log('üîÑ autoScale executado');
                    const slider = document.getElementById('pdf-root-wrapper');
                    const previewSide = document.getElementById('preview-side');
                    const root = document.getElementById('pdf-root');
                    if (!slider || !root || !previewSide) return;

                    // Pegar dimens√µes do container pai e da janela
                    const containerWidth = previewSide.clientWidth;
                    const wrapperHeight = window.innerHeight * 0.85;

                    const a4WidthMm = 210;
                    const a4HeightMm = 297;
                    const mmToPx = 3.78;
                    const a4WidthPx = a4WidthMm * mmToPx;
                    const a4HeightPx = a4HeightMm * mmToPx;

                    // Margens de seguran√ßa (padding do container)
                    const hPadding = 40;
                    const vPadding = 100; // Reduzido para permitir maior zoom

                    // Fator de escala para LARGURA
                    const scaleX = (containerWidth - hPadding) / a4WidthPx;

                    // Fator de escala para ALTURA
                    const scaleY = (wrapperHeight - vPadding) / a4HeightPx;

                    // Escolher o MENOR dos dois para garantir que cabe inteiro (logica "contain")
                    let baseScale = Math.min(scaleX, scaleY);

                    // Limite m√°ximo para n√£o ficar gigante em telas grandes
                    if (baseScale > 1.2) baseScale = 1.2;

                    const userZoom = (window.state && window.state.cfg && window.state.cfg.zoom) ? window.state.cfg.zoom : 1;
                    const finalScale = baseScale * userZoom;

                    root.style.transform = `scale(${finalScale})`;

                    // --- CORRE√á√ÉO DE SCROLL (PROFISSIONAL) ---
                    // Resetar altura do wrapper para deixar o CSS controlar
                    slider.style.height = "";

                    // Calcular diferen√ßa visual para corrigir scroll
                    const scrollHeight = root.scrollHeight;
                    const scaledHeight = scrollHeight * finalScale;
                    const difference = scaledHeight - scrollHeight;

                    // Aplicar margem
                    if (difference > 0) {
                        root.style.marginBottom = (difference + 100) + "px";
                    } else {
                        root.style.marginBottom = "100px";
                    }

                    // --- ATUALIZA√á√ÉO DO CONTADOR DE P√ÅGINAS ---
                    const pageCount = root.querySelectorAll('.a4-container').length;
                    const pageEl = document.getElementById('page-count');
                    if (pageEl) {
                        pageEl.innerText = `${pageCount} ${pageCount > 1 ? 'P√ÅGINAS' : 'P√ÅGINA'}`;
                    }

                    // Deixa espa√ßo extra no final para o scroll de m√∫ltiplas p√°ginas
                    root.style.marginBottom = (root.offsetHeight * 0.1) + "px";
                }

                window.autoScale = autoScale;

                // Monitorar mudan√ßas de tamanho com Debounce para evitar "piscadas"
                let resizeTimeout;
                const debouncedAutoScale = () => {
                    clearTimeout(resizeTimeout);
                    resizeTimeout = setTimeout(() => {
                        autoScale();
                    }, 100); // Espera 100ms para estabilizar layout antes de redimensionar
                };

                const resizeObserver = new ResizeObserver(() => { debouncedAutoScale(); });
                const previewSide = document.getElementById('preview-side');
                if (previewSide) resizeObserver.observe(previewSide);

                // Atualizar preview quando a janela for redimensionada
                window.addEventListener('resize', debouncedAutoScale);

                // Observer para quando o conte√∫do do documento mudar
                const mutationObserver = new MutationObserver(autoScale);
                const target = document.getElementById('pdf-root');
                if (target) mutationObserver.observe(target, { childList: true, subtree: true });

                // --- MECANISMO DE NAVEGA√á√ÉO ISOLADO NO WRAPPER ---
                const slider = document.getElementById('pdf-root-wrapper');
                let isDown = false;
                let startX, startY, scrollLeft, scrollTop;
                let idleTimer = null;

                function resetIdleTimer() {
                    if (idleTimer) clearTimeout(idleTimer);
                    idleTimer = setTimeout(() => { window.resetView(); }, 15000); // 15 segundos de inatividade
                }

                window.resetView = function () {
                    if (window.state) {
                        window.state.cfg.zoom = 0.8; // Redimensionar para 80%
                        const valEl = document.getElementById('zoom-val');
                        if (valEl) valEl.innerText = '80%';
                    }

                    autoScale();

                    setTimeout(() => {
                        const slider = document.getElementById('pdf-root-wrapper');
                        if (!slider) return;

                        // Centralizar horizontalmente (Igual ao carregamento inicial)
                        const centerX = (slider.scrollWidth - slider.clientWidth) / 2;

                        slider.scrollTo({
                            top: 0,
                            left: centerX,
                            behavior: 'smooth'
                        });
                    }, 60);
                }


                const startDrag = (e) => {
                    if (e.target.closest('button, input, select')) return;
                    isDown = true;
                    slider.style.cursor = 'grabbing';
                    resetIdleTimer();

                    const pageX = e.pageX || (e.touches ? e.touches[0].pageX : 0);
                    const pageY = e.pageY || (e.touches ? e.touches[0].pageY : 0);

                    startX = pageX - slider.offsetLeft;
                    startY = pageY - slider.offsetTop;
                    scrollLeft = slider.scrollLeft;
                    scrollTop = slider.scrollTop;
                };

                const endDrag = () => {
                    isDown = false;
                    slider.style.cursor = 'grab';
                };

                const moveDrag = (e) => {
                    if (!isDown) return;
                    e.preventDefault();
                    resetIdleTimer();

                    const pageX = e.pageX || (e.touches ? e.touches[0].pageX : 0);
                    const pageY = e.pageY || (e.touches ? e.touches[0].pageY : 0);

                    const x = pageX - slider.offsetLeft;
                    const y = pageY - slider.offsetTop;
                    const walkX = (x - startX) * 2;
                    const walkY = (y - startY) * 2;

                    slider.scrollLeft = scrollLeft - walkX;
                    slider.scrollTop = scrollTop - walkY;
                };

                slider.addEventListener('mousedown', startDrag);
                slider.addEventListener('touchstart', startDrag, { passive: true });
                window.addEventListener('mouseup', endDrag);
                window.addEventListener('touchend', endDrag);
                slider.addEventListener('mousemove', moveDrag);
                slider.addEventListener('touchmove', moveDrag, { passive: false });
                slider.addEventListener('click', resetIdleTimer);

                // Executar inicial (Sincronizado com os mesmos par√¢metros do resetView)
                setTimeout(() => { if (window.resetView) window.resetView(); }, 500);
            </script>

            <!-- LANDING CONTENT BELOW PREVIEW -->
            <div class="max-w-4xl w-full mt-20 space-y-20 pb-40 no-print">
                <section class="text-center">
                    <h2 class="text-3xl font-black mb-4">Privacidade Levada a S√©rio</h2>
                    <p class="text-slate-500 max-w-2xl mx-auto">Sabe aquele medo de colocar os dados do seu cliente em
                        um site qualquer? Aqui isso n√£o existe. O <b>Firmou</b> n√£o tem servidor de banco de dados. Tudo
                        o que voc√™ digita √© processado apenas no seu navegador.</p>
                </section>

                <div class="grid md:grid-cols-3 gap-8">
                    <div class="bg-white dark:bg-slate-800 p-8 rounded-3xl shadow-xl">
                        <i class="fa-solid fa-shield-halved text-4xl text-blue-600 mb-6"></i>
                        <h4 class="font-black mb-2 uppercase">100% Offline-First</h4>
                        <p class="text-xs text-slate-500">Funciona mesmo se a internet cair enquanto voc√™ edita. O
                            localstorage √© seu aliado.</p>
                    </div>
                    <div class="bg-white dark:bg-slate-800 p-8 rounded-3xl shadow-xl">
                        <i class="fa-brands fa-pix text-4xl text-emerald-500 mb-6"></i>
                        <h4 class="font-black mb-2 uppercase">Pix Integrado</h4>
                        <p class="text-xs text-slate-500">Gere QR Codes est√°ticos para facilitar o seu recebimento do
                            cliente.</p>
                    </div>
                    <div class="bg-white dark:bg-slate-800 p-8 rounded-3xl shadow-xl">
                        <i class="fa-solid fa-wand-magic-sparkles text-4xl text-amber-500 mb-6"></i>
                        <h4 class="font-black mb-2 uppercase">Templates Premium</h4>
                        <p class="text-xs text-slate-500">10 estilos profissionais para passar confian√ßa na hora da
                            cobra√ßa.</p>
                    </div>
                </div>

                <!-- FAQ SECTION -->
                <section id="faq" class="space-y-6 bg-white dark:bg-slate-800 p-10 rounded-[40px] shadow-2xl">
                    <h3 class="text-2xl font-black text-center mb-10">Tire suas d√∫vidas</h3>
                    <div class="space-y-4">
                        <details class="group border-b dark:border-slate-700 pb-4">
                            <summary
                                class="flex justify-between items-center font-bold cursor-pointer hover:text-blue-600 transition-colors">
                                Como os dados s√£o salvos? <i
                                    class="fa-solid fa-chevron-down group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="text-xs text-slate-500 mt-4 leading-relaxed">Tudo fica no <b>LocalStorage</b> do
                                seu navegador. √â como se fosse uma gaveta digital dentro do seu Chrome ou Safari. Se
                                voc√™ limpar o hist√≥rico de navega√ß√£o profundamente, esses dados podem sumir, por isso
                                sempre recomendamos usar o bot√£o "Exportar TXT".</p>
                        </details>
                        <details class="group border-b dark:border-slate-700 pb-4">
                            <summary
                                class="flex justify-between items-center font-bold cursor-pointer hover:text-blue-600 transition-colors">
                                D√° pra salvar em PDF? <i
                                    class="fa-solid fa-chevron-down group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="text-xs text-slate-500 mt-4 leading-relaxed">Sim! Usamos uma biblioteca potente
                                que "fotografa" o preview e gera um PDF no formato A4, pronto para enviar pelo WhatsApp.
                            </p>
                        </details>
                        <details class="group border-b dark:border-slate-700 pb-4">
                            <summary
                                class="flex justify-between items-center font-bold cursor-pointer hover:text-blue-600 transition-colors">
                                O que fazer se der erro na busca de CNPJ? <i
                                    class="fa-solid fa-chevron-down group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="text-xs text-slate-500 mt-4 leading-relaxed">Pode ser que a API esteja fora do ar
                                ou o CNPJ seja muito novo. Se isso acontecer, voc√™ pode digitar os dados manualmente sem
                                problemas.</p>
                        </details>
                        <details class="group border-b dark:border-slate-700 pb-4">
                            <summary
                                class="flex justify-between items-center font-bold cursor-pointer hover:text-blue-600 transition-colors">
                                Como adicionar fotos no or√ßamento? <i
                                    class="fa-solid fa-chevron-down group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="text-xs text-slate-500 mt-4 leading-relaxed">V√° na aba <b>"Fotos"</b>, escolha at√©
                                3 imagens do servi√ßo e marque a op√ß√£o <b>"Exibir no PDF"</b>. As fotos aparecem
                                automaticamente no documento final com legendas opcionais.</p>
                        </details>
                        <details class="group border-b dark:border-slate-700 pb-4">
                            <summary
                                class="flex justify-between items-center font-bold cursor-pointer hover:text-blue-600 transition-colors">
                                Posso usar no celular? <i
                                    class="fa-solid fa-chevron-down group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="text-xs text-slate-500 mt-4 leading-relaxed">Sim! O Firmou √© 100% responsivo. No
                                celular, use os bot√µes <b>"Editar"</b> e <b>"Ver"</b> no topo para alternar entre o
                                formul√°rio e o preview do documento.</p>
                        </details>
                        <details class="group border-b dark:border-slate-700 pb-4">
                            <summary
                                class="flex justify-between items-center font-bold cursor-pointer hover:text-blue-600 transition-colors">
                                Como funciona o PIX QR Code? <i
                                    class="fa-solid fa-chevron-down group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="text-xs text-slate-500 mt-4 leading-relaxed">Digite sua chave PIX (CPF, email,
                                telefone ou chave aleat√≥ria) e o QR Code √© gerado automaticamente. <b>Importante:</b> O
                                QR Code √© est√°tico, ent√£o sempre confira os valores antes de enviar ao cliente.</p>
                        </details>
                        <details class="group border-b dark:border-slate-700 pb-4">
                            <summary
                                class="flex justify-between items-center font-bold cursor-pointer hover:text-blue-600 transition-colors">
                                Qual a diferen√ßa entre os templates? <i
                                    class="fa-solid fa-chevron-down group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="text-xs text-slate-500 mt-4 leading-relaxed">Cada template tem um estilo visual
                                √∫nico: <b>Clean</b> (minimalista), <b>Industrial</b> (constru√ß√£o), <b>Elegant</b>
                                (artes√£os), <b>Tech</b> (TI), <b>Corporate</b> (empresas), entre outros. Escolha o que
                                combina com seu neg√≥cio na aba "Estilo".</p>
                        </details>
                        <details class="group border-b dark:border-slate-700 pb-4">
                            <summary
                                class="flex justify-between items-center font-bold cursor-pointer hover:text-blue-600 transition-colors">
                                O LocalStorage est√° bloqueado, e agora? <i
                                    class="fa-solid fa-chevron-down group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="text-xs text-slate-500 mt-4 leading-relaxed">Alguns navegadores em modo an√¥nimo
                                bloqueiam o LocalStorage. Use o bot√£o <b>"Exportar TXT"</b> na aba "Arquivos" para
                                salvar seus dados antes de fechar o navegador. Voc√™ pode importar depois.</p>
                        </details>
                        <details class="group border-b dark:border-slate-700 pb-4">
                            <summary
                                class="flex justify-between items-center font-bold cursor-pointer hover:text-blue-600 transition-colors">
                                Posso criar v√°rios or√ßamentos? <i
                                    class="fa-solid fa-chevron-down group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="text-xs text-slate-500 mt-4 leading-relaxed">Sim! Gere o PDF do or√ßamento atual,
                                depois use o bot√£o de lixeira (üóëÔ∏è) no topo para limpar e come√ßar um novo. Ou exporte
                                cada or√ßamento em TXT para guardar no seu computador.</p>
                        </details>
                        <details class="group border-b dark:border-slate-700 pb-4">
                            <summary
                                class="flex justify-between items-center font-bold cursor-pointer hover:text-blue-600 transition-colors">
                                √â realmente gr√°tis? Tem pegadinha? <i
                                    class="fa-solid fa-chevron-down group-open:rotate-180 transition-transform"></i>
                            </summary>
                            <p class="text-xs text-slate-500 mt-4 leading-relaxed">100% gr√°tis, sem limites de uso. N√£o
                                pedimos cart√£o de cr√©dito nem cadastro. A √∫nica "pegadinha" √© que mostramos an√∫ncios
                                discretos para manter o projeto no ar. Simples assim!</p>
                        </details>
                    </div>
                </section>

                <footer class="text-center text-[10px] text-slate-400 font-bold uppercase tracking-widest">
                    <p>Firmou.com ¬© 2024 - O seu bra√ßo direito na presta√ß√£o de servi√ßos</p>
                    <button onclick="showPrivacy()" class="mt-2 underline hover:text-slate-600 block mx-auto">Pol√≠tica
                        de Privacidade</button>
                </footer>
            </div>
        </section>
    </main>

    <!-- PRIVACY MODAL -->
    <div id="privacy-mod"
        class="hidden fixed inset-0 z-[300] bg-slate-900/80 backdrop-blur flex items-center justify-center p-4">
        <div
            class="bg-white dark:bg-slate-800 w-full max-w-2xl rounded-[40px] shadow-2xl overflow-hidden flex flex-col max-h-[90vh]">
            <div class="p-8 border-b dark:border-slate-700 flex justify-between items-center">
                <h2 class="text-2xl font-black">Pol√≠tica de Privacidade</h2>
                <button onclick="closePrivacy()" class="w-10 h-10 rounded-full bg-slate-100 dark:bg-slate-700"><i
                        class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="p-8 overflow-y-auto custom-scrollbar text-sm leading-relaxed space-y-6">
                <p><b>Direto ao ponto:</b> Este site n√£o √© um espi√£o. N√≥s n√£o queremos seus dados nem os dos seus
                    clientes. Somos uma ferramenta de produtividade.</p>
                <div
                    class="bg-amber-50 dark:bg-amber-900/10 p-4 rounded-2xl border-l-4 border-amber-400 uppercase text-[10px] font-bold">
                    Resumo para quem trabalha em campo:</div>
                <ul class="space-y-3 list-disc pl-5">
                    <li><b>Nada sobe pro servidor:</b> O que voc√™ digita fica no SEU celular.</li>
                    <li><b>Propagandas:</b> Usamos Google AdSense. Elas ajudam a pagar o caf√© de quem criou o site pra
                        voc√™ usar de gra√ßa.</li>
                    <li><b>Cookies:</b> Usamos s√≥ o b√°sico pra saber se o site t√° caindo ou se muita gente t√° usando.
                    </li>
                    <li><b>Responsabilidade:</b> O orador (voc√™) √© o √∫nico respons√°vel pelos valores e dados escritos no
                        PDF final. Confira tudo antes de mandar um "enviado".</li>
                </ul>
                <p>Ao fechar este aviso, voc√™ concorda que o Firmou √© apenas um gerador visual e n√£o se responsabiliza
                    por acordos comerciais entre voc√™ e seu cliente.</p>
            </div>
            <div class="p-8 bg-slate-50 dark:bg-slate-750">
                <button onclick="closePrivacy()"
                    class="w-full bg-slate-900 dark:bg-white dark:text-slate-900 text-white font-black py-4 rounded-2xl">ENTENDI,
                    T√Å FIRMADO!</button>
            </div>
        </div>
    </div>

    <!-- COOKIE CONSENT -->
    <div id="cookie-bar"
        class="fixed bottom-6 right-6 left-6 md:left-auto md:w-[400px] z-[250] bg-slate-900 text-white p-6 rounded-[30px] shadow-2xl flex flex-col gap-4 transform translate-y-40 transition-transform duration-700 border border-white/10 glass-dark hidden">
        <div class="flex items-start gap-4">
            <div class="w-12 h-12 bg-firmou-amber rounded-2xl flex items-center justify-center shrink-0"><i
                    class="fa-solid fa-cookie-bite text-slate-900 text-2xl"></i></div>
            <p class="text-[10px] md:text-xs text-slate-300 leading-tight">Privacidade e Cookies: Usamos dados an√¥nimos
                para melhorar sua experi√™ncia. Nada pessoal √© coletado. Aceitar ajuda a manter o projeto gr√°tis!</p>
        </div>
        <div class="flex gap-2">
            <button onclick="saveConsent(true)"
                class="flex-1 bg-white text-slate-900 font-bold py-2 rounded-xl text-xs">ACEITAR</button>
            <button onclick="saveConsent(false)"
                class="flex-1 bg-slate-700 font-bold py-2 rounded-xl text-xs">RECUSAR</button>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script type="module" src="js/main.js"></script>

    <!-- DIAGNOSTIC SCRIPT -->
    <script>
        setTimeout(() => {
            if (!window.upd) {
                console.warn("Firmou: Scripts n√£o carregados. Protocolo file:// detectado ou erro de seguran√ßa.");
                const alertBox = document.getElementById('alert-fake');
                if (alertBox) {
                    alertBox.innerHTML = `
                        <div class="p-2">
                             <p class="font-black text-red-600">‚ö†Ô∏è ERRO DE SEGURAN√áA DO NAVEGADOR</p>
                             <p class="text-[10px] text-red-800 mt-1 leading-tight">O navegador bloqueou os scripts por seguran√ßa. <br><b>Como resolver:</b> Clique com o bot√£o direito no arquivo index.html no VS Code e escolha <b>'Open with Live Server'</b>.</p>
                        </div>
                    `;
                    alertBox.classList.remove('hidden', 'bg-amber-50', 'bg-amber-900/20');
                    alertBox.classList.add('bg-red-50', 'border-red-300');
                }
            }
        }, 1500);
    </script>

</body>

</html>